---
title:  "时序异常检测的技术和应用_1"
date: 2021-02-20 15:05:20

author: "chiechie"
subtitle: "先引出问题，搭个架子"
header-style: text
categories: 技术类
tags:
  - 时间序列
  - 统计  
  - 量化交易
---

## 时序异常检测有什么实际用途？
时序异常检测是为了监控实时数据流的健康状况。时序异常检测的应用场景挺多，比如风控系统，运维系统，以及安防领域：
- 风控系统想做的事情，比如电商的商品评价内容监控，微博的用户发布内容监控，微信的聊天记录和朋友圈监控，不可以出现黄赌毒以及政治敏感的话题。![](/images/user_behavior.png)
- 运维系统：会做一切跟监控相关的事情，比如监控机器是否异常，某个服务是是否挂了，海量日志是不是出现了新模式。
- 安防领域 ：比如说，使用摄像头监控是否有可疑人员或者异常行为，对森林进行监控,预防火灾。
- 航空领域，比如NASA有一个航天器在进行遥感探测任务，可以探测到不同频道的数据，比如能量指标和热量指标，想通过对这些指标做异常检测来实现监控探测对象是否异常了（火星or else）。

> chiechie脑洞时间-「温水煮青蛙」之 青蛙如何避免自己被煮熟？
>  - 一个策略是这样的：青蛙要记住过去很长一段时间的水温数据 和 变化趋势，时刻提醒自己--在一个水温持续上升的水池中泡太久可不行。这个策略 需要更多的脑容量 以及 自己的警觉性，可能在温泉中就享受不到泡澡的乐趣了
> - 还有一个策略是：青蛙心中又一个水温过高的预警值---"60摄氏度"，当超过这个问题，他就退场了。这要求 这只青蛙是一只见过世面的老练青蛙，无论在温泉还是在煮锅中，老练青蛙都丛容地享受泡澡的乐趣。

## 两大类时序异常检测的应用场景

时序异常检测的应用场景大致可分为两类-关注所有非正常case和只关注特定异常case：
- 「关注所有非正常的case的场景」：在这种场景下，无论是data-driven 还是rule-based的思路，异常都不是很好精准描述，或者说，业务人员对异常的认知还不够，比如微信或者淘宝的的风控团队，想找出一帮薅羊毛的用户和赌球的用户，但是并不知道这帮用户的行为模式是什么。虽然有少数种子用户，但是可惜样本太少，以此得到的画像不一定可靠。
- 「只关注特定的异常case的场景」：在这种场景下，使用data-driven或者rule-based的方法可以很好地定义异常
  - 比如某个服务的调用成功率监控：可以用rule-base的静态告警策略搞定。
  - 比如抖音的黄色内容监控：「黄色内容」这种模式定义很明确，更像模式识别，对应的技术是有监督算法。

## 有哪些做异常检测的工具呢？
对于上面两种检测需求，使用的工具还是有比较大的区别的。
- 对于第一种需求：可以使用基于生成模型的方法
  - 对正常模式没有先验知识时，随便选一个模型用
  - 对正常模式有先验知识时，需要配置生成模型的超参数。
  
- 对于第二种需求：可以使用的方法就太多了
  - 人工rule: 缺点是配置成本有点高，但总是有一些规则是可复用的，比如多个机器可用同一个cpu告警策略，多个服务可用同一个成功率告警策略。eg，同比超过20%
  - 判别模型：所谓rule不够数据来凑，不过这种方法适用范围也有限，仅当数据获取成本很低的时候才适用。
  - 人工rule和判别模型的混合版：异常模式用户心里很明确，但是无法用rule精确表达，需要依靠data-driven 和 rule-based两个方式一起来定义异常，举个例子
    - 上升类型的异常
    - 违背了周期性的异常
  
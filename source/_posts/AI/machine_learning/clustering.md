---
title: 基于Graph的聚类算法
author: chiechie
mathjax: true
date: 2021-06-23 11:20:42
tags:
- 图
- 聚类
- 日志聚类
categories:
- 数据结构
---


## 层次聚类

除了kmeans，聚类算法中还有一类更简单直观的方法，就是层次聚类。

层次聚类最大的优点，它一次性地得到了整个聚类的过程，只要得到了上面那样的聚类树，想要分多少个cluster都可以直接根据树结构来得到结果，改变cluster数目不需要再次计算数据点的归属。

层次聚类的缺点是计算量比较大，因为要每次都要计算多个cluster内所有数据点的两两距离。

另外，由于层次聚类使用的是贪心算法，得到的显然只是局域最优，不一定就是全局最优，这可以通过加入随机效应解决，这就是另外的问题了。




## 基于Graph的聚类

基于Graph的聚类算法，大致思路是，计算样本两两之间的相似度，并设定阈值，高于阈值就右边，低于阈值就无边，以此构造有权无向图，权重即为相似度。

### 谱聚类

谱聚类的流程是：

输入：n个样本, 类别k

1. 根据样本两两之间的相似度，构建有权无向图，以及邻接矩阵W。
2. 计算出拉普拉斯矩阵L，对L做谱分解（相当于降维）：计算拉普拉斯矩阵L的最小的k个特征向量u1, u2,...,uk,将这些向量组成n*k维的矩阵U,
3. 将U中的每一行作为一个样本，共n个样本，使用k-means对这n个样本进行聚类

得到簇划分C(c1,c2,...ck).


### 如何判断两个cluster之间的距离？

一开始每个数据点独自作为一个类，它们的距离就是这两个点之间的距离。而对于包含不止一个数据点的cluster，就可以选择多种方法了。最常用的，就是average-linkage，即计算两个cluster各自数据点的两两距离的平均值。类似的还有single-linkage/complete-linkage，选择两个cluster中距离最短/最长的一对数据点的距离作为类的距离。个人经验complete-linkage基本没用，single-linkage通过关注局域连接，可以得到一些形状奇特的cluster，但是因为太过极端，所以效果也不是太好。


## 聚类应用

### 日志分析


### 图像分割

图像的分割是图聚类的其中一个应用场景。把图像中的每一个像素点看成是一个item，那么图像分割的任务就是将所有的items进行聚类，属于一个类里面的所有像素就构成了一个区域，最终的分割结构就是若干个区域组成的。由此我们过渡到本文的第二部分，基于图的图像分割算法。


## 参考

1. https://patentimages.storage.googleapis.com/34/c0/df/3417293b1602a5/CN105468677A.pdf
2. [常用聚类算法综述](https://zhuanlan.zhihu.com/p/78382376)
3. [](https://buptjz.github.io/2014/04/21/cluster)